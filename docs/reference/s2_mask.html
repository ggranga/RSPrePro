<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Apply cloud masks — s2_mask • An R toolbox to find, download an preprocess Sentinel-2 data</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Google analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11080708-8', 'auto');
  ga('send', 'pageview');

</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sen2r</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ranghetti/sen2r/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply cloud masks</h1>
    </div>

    
    <p>Apply a cloud mask to a Sentinel-2 product. Since
raster functions are used to perform computations, output files
are physical rasters (no output VRT is allowed).</p>
    

    <pre class="usage"><span class='fu'>s2_mask</span>(<span class='no'>infiles</span>, <span class='no'>maskfiles</span>, <span class='kw'>mask_type</span> <span class='kw'>=</span> <span class='st'>"cloud_medium_proba"</span>, <span class='kw'>max_mask</span> <span class='kw'>=</span> <span class='fl'>80</span>,
  <span class='kw'>outdir</span> <span class='kw'>=</span> <span class='st'>"./masked"</span>, <span class='kw'>tmpdir</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>format</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>subdirs</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>compress</span> <span class='kw'>=</span> <span class='st'>"DEFLATE"</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>infiles</th>
      <td><p>A vector of input filenames. Input files are paths
of products already converted from SAFE format to a
format managed by GDAL (use <a href='s2_translate.html'>s2_translate</a> to do it);
their names must be in the sen2r naming convention
(<a href='s2_shortname.html'>s2_shortname</a>).</p></td>
    </tr>
    <tr>
      <th>maskfiles</th>
      <td><p>A vector of filenames from which to take the
information about cloud coverage (for now, only SCL products
have been implemented). It is not necessary that <code>maskfiles</code>
elements strictly match <code>infiles</code> ones. Input files are paths
of products already converted from SAFE format to a
format managed by GDAL (use <a href='s2_translate.html'>s2_translate</a> to do it);
their names must be in the sen2r naming convention
(<a href='s2_shortname.html'>s2_shortname</a>).</p></td>
    </tr>
    <tr>
      <th>mask_type</th>
      <td><p>(optional) Character vector which determines the type of
mask to be applied. Accepted values are:</p><ul>
<li><p>"nodata": mask pixels checked as "No data" in the SCL product;</p></li>
<li><p>"cloud_high_proba": mask pixels checked as "No data" or
"Cloud (high probability)" in the SCL product;</p></li>
<li><p>"cloud_medium_proba": mask pixels checked as "No data" or
"Cloud (high or medium probability)" in the SCL product;</p></li>
<li><p>"cloud_low_proba": mask pixels checked as "No data" or
"Cloud (any probability)" in the SCL product;</p></li>
<li><p>"cloud_and_shadow": mask pixels checked as "No data",
"Cloud (any probability)" or "Cloud shadow" in the SCL product;</p></li>
<li><p>"cloud_shadow_cirrus": mask pixels checked as "No data",
"Cloud (any probability)", "Cloud shadow" or "Thin cirrus"
in the SCL product;</p></li>
<li><p>a string in the following form: "scl_n_m_n", where n, m and n are one or
more SCL class numbers (e.g. "scl_0_8_9_11"): mask pixels corresponding
to the classes specified in the string. E.g. string "scl_0_8_9_11" can
be used to mask classes 0 ("No data"), 8-9 ("Cloud (high or medium
probability)") and 11 ("Snow");</p></li>
<li><p>"opaque_clouds" (still to be implemented).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>max_mask</th>
      <td><p>(optional) Numeric value (range 0 to 100), which represents
the maximum percentage of allowed masked surface (by clouds or any other
type of mask chosen with argument <code>mask_type</code>) for producing outputs.
Images with a percentage of masked surface greater than <code>max_mask</code><!-- % -->
are not processed (the list of expected output files which have not been
generated is returned as an attribute, named "skipped").
Default value is 80.
Notice that the percentage is computed on non-NA values (if input images
had previously been clipped and masked using a polygon, the percentage is
computed on the surface included in the masking polygons).</p></td>
    </tr>
    <tr>
      <th>outdir</th>
      <td><p>(optional) Full name of the output directory where
the files should be created (default: "current directory"masked"
subdir of current directory).
<code>outdir</code> can bot be an existing or non-existing directory (in the
second case, its parent directory must exists).
If it is a relative path, it is expanded from the common parent
directory of <code>infiles</code>.</p></td>
    </tr>
    <tr>
      <th>tmpdir</th>
      <td><p>(optional) Path where intermediate VRT will be created.
Default is in a temporary directory.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>(optional) Format of the output file (in a
format recognised by GDAL). Default is the same format of input images
(or "GTiff" in case of VRT input images).</p></td>
    </tr>
    <tr>
      <th>subdirs</th>
      <td><p>(optional) Logical: if TRUE, different indices are
placed in separated <code>outfile</code> subdirectories; if FALSE, they are placed in
<code>outfile</code> directory; if NA (default), subdirectories are created only if
more than a single spectral index is required.</p></td>
    </tr>
    <tr>
      <th>compress</th>
      <td><p>(optional) In the case a GTiff format is
present, the compression indicated with this parameter is used.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>(optional) Logical: if TRUE, masking is conducted using parallel
processing, to speed-up the computation for large rasters.
The number of cores is automatically determined; specifying it is also
possible (e.g. <code>parallel = 4</code>).
If FALSE (default), single core processing is used.
Multiprocess masking computation is always performed in singlecore mode
if <code>format != "VRT"</code> (because in this case there is no gain in using
multicore processing).</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>(optional) Logical value: should existing output files be
overwritten? (default: FALSE)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector with the names of the created products.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>License: GPL 3.0</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>
          </ul>

    <h2>Author</h2>
    
Luigi Ranghetti, phD (2017) <a href='mailto:ranghetti.l@irea.cnr.it'>ranghetti.l@irea.cnr.it</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Luigi Ranghetti, Lorenzo Busetto.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
